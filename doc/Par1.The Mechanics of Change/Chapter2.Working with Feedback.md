# 피드백 활용  
#### 편집 후 기도하기 (Edit and Pray)  
#### 보호 후 수정하기 (Cover and Modify)  
#### 단위 테스트 (Unit Test)

## 편집 후 기도하기
#### 신중함의 오류 : 신중하고, 깊은 주의는 안정성과 비례하지 않는다.
```
아무리 신중하고, 주의 깊은 의사라 할지라도
버터를 바르는 칼로 외과 수술을 한다면,
아무도 그에게 수술을 받으려고 하지 않을 것이다.
```
#### 주의를 기울여 작업하더라도 적절한 도구와 기법이 없다면 효과를 거두기 어렵다.

## 보호 후 수정하기
* 안전망 개념  
> 변경에 따른 문제가 발생해도 이로 인해 나머지 코드에 미치는 영향을 최소화하는 것  
  * 적절한 테스트 루틴의 배치  
    * 변경 작업에 대한 쉬운 확인  
    * 문제 발생 시 빠르게 원인 감지  
  > 보호 후 수정하기 방식도 신중한 작업을 필요로 한다.  
  
* 회귀 테스트(regression test)  
  > 주기적으로 테스트를 실행해 정상적인 동작 여부의 확인  
  
* 소프트웨어 바이스(software vise)  
  > 동작 대부분의 고정, 변경 대상에 대한 확인  
  
#### 자기 자신이 수행 중인 작업을 더 정밀하게 통제

### 회귀 테스트의 현실  
> 일반적으로 회귀테스트는 애플리케이션 인터페이스를 통해 이뤄진다.  

우리는 **실패한 테스트**의 **분명한 원인**이 필요하다.
#### 원인을 찾기 위한 여정 = 고난

### 단위 테스트와 빠른 피드백 시나리오    
**QA로부터의 피드백(회귀 테스트) -> 변경 요구**
* 변경 작업 준비
  * 해당 모듈에 대한 철저히 검증된 단위 테스트 루틴  
  * 해당 모듈에 대한 대략적이고, 빠른 이해  
  
* 변경 작업에 대한 판단  
  > 어떻게 변경할 것인가?  

  * 쉬운 케이스 : 테스트 루틴만으로도 판단 가능  
  * 테스트 루틴만으로 판단이 어렵다면? **추가 비용 발생**  
    > 실제 변경 전 코드에 대한 이해가 필요  
    > 변경 작업에 대한 확신이 필요  
      
* 판단이 어렵다면 리팩토링한다.  
  * 몇 개의 메소드를 추출해 조건문을 이동시킨다.  
    > 변경 시 단위 테스트 루틴을 실행  
  * 조건문에 대한 실수를 저질러도 실패한 테스트 덕분에 빠르게 수정이 가능하다.  
  * 리팩토링 과정을 통해 코드는 훨씬 더 명확해진다.  
  
* 이제 변경에 대한 테스트 루틴을 추가하자  
  * 다음 프로그래머는 작업하기가 훨씬 쉬워진다.  
  
#### 피드백을 몇 분만에 받는 것과 하룻밤이 지나야 받는 것 중 무엇을 택할 것인가?
#### 시스템 수준의 회귀테스트는 중요하다. 
#### 하지만 소규모 수준의 모듈별 테스트도 매우 중요하다. (변경 작업 판단에 대한 추가 비용을 감소)

## 단위 테스트
단위 테스트의 기본 개념은 **독립된 개별 소프트웨어 컴포넌트**에 대한 테스트  
> 컴포넌트 : 시스템의 가장 원자적인 동작단위  
#### 시스템을 보는 추상화 레벨과 시스템의 구성 방식에 따라
#### "가장 원자적인"의 의미는 달라질 수 있다.  

### 대규모 테스트의 문제점  
```
소프트웨어의 오류는 결국 소프트웨어의 각 조각들이 통합될 때 발생한다.
그렇다면, 대규모 테스트가 더 중요한 것 아닐까?
```
대규모 테스트는 중요하다. 하지만 문제가 있다.  

* 오류 위치 파악  
  > 테스트 루틴이 테스트 대상으로 멀어질수록, 테스트 실패가 의미하는 바를 파악하기 위한  
  > 분석할 면적이 넓어진다. // 면적이라고 정리한 이유는 분석할 범위가 선형으로 커지지 않기 때문에  
  
* 실행 시간  
  > 지나치게 오래 걸리는 테스트는 실행을 망설이게 만든다.  
  
* 커버리지  
  > 코드 조각과 그 코드 조각을 실행시키는 값들의 연결 관계는 파악하기 어렵다.  
  > 테스트 루틴이 실행 하는 코드의 추상화 레벨이 높으면 높을수록, 테스트 루틴의 코드량도 많아진다.  
  
#### 문제점들은 서로 얽혀서 다가오고, 서로를 가중시킨다.  

### 좋은 단위 테스트의 조건  
빠른 피드백과 판단 -> 테스트 실행 주기 감축  
1. 실행 속도가 빠르다.  
  > 실행에 0.1초가 걸리는 단위테스트는 느린 단위 테스트  
2. 오류 위치 파악에 도움이 된다.  
3. **테스트 하네스** 내부에서 단독으로 인스턴스화될 수 있어야 한다.  

* 단위 테스트에서 분리할 대상  
> 좋은 단위 테스트의 조건을 충족하기 어렵게 만드는 애들  
1. 데이터 베이스와의 연동  
2. 네트워크를 통한 통신  
3. 파일시스템과의 I/O  
4. 독립적인 테스트 실행을 위한 특별한 작업 요구 (ex : 설정파일 편집)  
#### 나쁜 것은 아니지만, 빠른 테스트 수행 시간을 유지하는 것도 매우 중요하기 때문에 분리  

## 상위 수준의 테스트  
#### 상위 수준의 테스트를 통해 우리는 다수 클래스들의 동작을 한번에 확인할 수 있다.
#### 상위 수준의 테스트가 완료되면
#### 개별 클래스(또는 컴포넌트)에 대한 테스트 루틴 작성도 쉬워질 때가 많다.

### 나의 의견 : 접근 제어자에 의해 제한되는 테스트 루틴에 집착하지 말자
> 접근 제어자로 제한한 이유에는 그 이유가 있다.  
> 제한한 부분에 대한 상위 수준의 테스트가 한 방법이 될 수 있다.  
#### 컴포넌트의 최초 클라이언트 관점에서 테스트를 바라볼 때 
#### "잘못된 분리와 제한"이 보이기도 한다.
